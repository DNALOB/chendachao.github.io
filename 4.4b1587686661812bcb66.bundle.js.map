{"version":3,"sources":["webpack:///./src/app/components/dialog.css","webpack:///./src/app/components/dialog.js"],"names":["SetQRCode","showModalClass","hideModalClass","LOCAL_REGEXP","mySite","test","window","location","origin","dialog","document","querySelector","dismissTriggers","querySelectorAll","downloadBtn","qrcodeHandler","img","setAttribute","dialogPolyfill","registerDialog","addEventListener","showModal","classList","add","setTimeout","remove","canvas","createElement","QRCodeDim","width","height","margin","QRCode","toCanvas","errorCorrectionLevel","quality","version","color","then","cvs","imgDim","logo","ctx","getContext","logoObj","Image","src","onload","bgWhiteMargin","lineWidth","lineJoin","lineCap","strokeStyle","beginPath","rect","stroke","fillStyle","fillRect","drawImage","toDataURL","err","console","error","shake","close","message","download","imgData","hostname","href","forEach","ele","returnValue","event","getBoundingClientRect","isInDialog","top","clientY","bottom","left","clientX","right","ev","preventDefault"],"mappings":"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","file":"4.4b1587686661812bcb66.bundle.js","sourcesContent":["// extracted by mini-css-extract-plugin\nexport {};","import QRCode from 'qrcode';\nimport dialogPolyfill from 'dialog-polyfill';\nimport './dialog.css';\n\nfunction SetQRCode() {\n  // const showModalClass = 'scale-in';\n  // const hideModalClass = 'scale-out';\n  const showModalClass = 'appear-from-top';\n  const hideModalClass = 'disappear-from-top';\n  // const showModalClass = 'appear-from-bottom';\n  // const hideModalClass = 'disappear-from-bottom';\n\n  let LOCAL_REGEXP = /localhost|127.0.0.1/;\n  let mySite = LOCAL_REGEXP.test(window.location.origin) ? 'https://chendachao.github.io' : window.location.origin;\n\n  var dialog = document.querySelector('#dialog');\n  var dismissTriggers = document.querySelectorAll('.dialog-dismiss-trigger');\n  var downloadBtn = document.querySelector('.download-btn');\n  let qrcodeHandler = document.querySelector('.qrcode-handler');\n\n  let img = document.querySelector('.mobile-qrcode');\n  img.setAttribute('alt', mySite);\n\n  dialogPolyfill.registerDialog(dialog);\n\n  qrcodeHandler.addEventListener('click', () => {\n    dialog.showModal();\n\n    dialog.classList.add(showModalClass);\n    setTimeout(() => {\n      dialog.classList.remove(showModalClass);\n    }, 500);\n\n    let canvas = document.createElement('canvas');\n    const QRCodeDim = {\n      width: 320,\n      height: 320,\n      margin: 3,\n    };\n    QRCode.toCanvas(canvas, mySite, {\n      width: QRCodeDim.width,\n      height: QRCodeDim.height,\n      margin: QRCodeDim.margin,\n      errorCorrectionLevel: 'H',\n      quality: 1,\n      version: 5, // 6\n      color: {\n        // dark: \"#010599FF\",\n        // light: \"#f5f5f5\"\n      }\n    })\n      .then(cvs => {\n        const imgDim = {\n          //logo dimention\n          width: 30,\n          height: 30,\n        };\n        const logo = 'favicon.ico';\n        const ctx = cvs.getContext('2d');\n        const logoObj = new Image();\n        logoObj.src = logo;\n        logoObj.onload = function () {\n          // fill logo background, cos the logo by default is transparent\n          const bgWhiteMargin = 20;\n\n          // stroke margin\n          ctx.lineWidth = bgWhiteMargin / 3;\n          ctx.lineJoin = 'round';\n          ctx.lineCap = 'round';\n          ctx.strokeStyle = '#ffffff';\n          ctx.beginPath();\n          ctx.rect(\n            cvs.width / 2 - imgDim.width / 2 - bgWhiteMargin / 4, \n            cvs.width / 2 - imgDim.width / 2 - bgWhiteMargin / 4, \n            imgDim.width + bgWhiteMargin, \n            imgDim.height + bgWhiteMargin\n            );\n          ctx.stroke();\n\n          // fill content color\n          ctx.fillStyle = '#f5f5f5';\n          ctx.fillRect(\n            cvs.width / 2 - imgDim.width / 2 - bgWhiteMargin / 4,\n            cvs.height / 2 - imgDim.height / 2 - bgWhiteMargin / 4,\n            imgDim.width + bgWhiteMargin,\n            imgDim.height + bgWhiteMargin\n          );\n\n          ctx.drawImage(\n            logoObj,\n            cvs.width / 2 - imgDim.width / 2 + bgWhiteMargin / 4,\n            cvs.height / 2 - imgDim.height / 2 + bgWhiteMargin / 4,\n            imgDim.width,\n            imgDim.height\n          );\n          img.src = cvs.toDataURL('image/png');\n        };\n      })\n      .catch(err => {\n        img.setAttribute('alt', `Failed to generate QRCode, please visit ${mySite}`);\n        console.error(err);\n      });\n  });\n\n  function shake() {\n    dialog.classList.add('shake');\n    setTimeout(() => dialog.classList.remove('shake'), 300);\n  }\n\n  function close(message) {\n    dialog.classList.add(hideModalClass);\n    setTimeout(() => {\n      dialog.classList.remove(hideModalClass);\n      dialog.close(message);\n    }, 300);\n  }\n\n  function download(imgData) {\n    downloadBtn.download = `${window.location.hostname}.png`;\n    downloadBtn.href = imgData;\n  }\n\n  dismissTriggers.forEach(ele => {\n    ele.addEventListener('click', function () {\n      close();\n    });\n  });\n\n  downloadBtn.addEventListener('click', function () {\n    close();\n    download(img.src);\n  });\n\n  dialog.addEventListener('close', function() {\n    dialog.returnValue = '';\n  });\n\n  dialog.addEventListener('click', function (event) {\n    const rect = dialog.getBoundingClientRect();\n    // const isInDialog=(rect.top <= event.clientY && event.clientY <= rect.top + rect.height\n    //   && rect.left <= event.clientX && event.clientX <= rect.left + rect.width);\n    const isInDialog =\n      rect.top <= event.clientY && event.clientY <= rect.bottom && rect.left <= event.clientX && event.clientX <= rect.right;\n    if (!isInDialog) {\n      // dialog.close();\n      shake();\n    }\n  });\n\n  dialog.addEventListener('cancel', ev => {\n    ev.preventDefault();\n    shake();\n  });\n}\n\nexport default SetQRCode;\n"],"sourceRoot":""}